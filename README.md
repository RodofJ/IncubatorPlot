# KoiProject
Koi are a fish; they are carp that have been bred to have various types of colors and patterns. This hobby originated in Japan and there are Japanese names used to describe different types of Koi, e.g. a Kohaku is a fish with a white base with orange or red patterns on top of that base. A common question is, “what kind of Koi is this?”. This project was an attempt to create an algorithm to identify the type of Koi in an image.

This was not intended to be a commercial product: there are probably not that many people interested in Koi so it’s hard to imagine how such a product could be monetized. The end product was only moderately successful at identifying Koi in “standardized” pictures - these are images of a single Koi, taken from above with the fish’s head at the bottom of the picture, typically with a blue background. This is the standard way more serious hobbyists photograph fish. Of course, the more serious the hobbyist the less likely they are to need help identifying a fish. To be generally useful, this algorithm would probably need to be enhanced to identify individual fish within a picture, and to be much more robust in dealing with “non standardized” pictures.

I used the KoiScraper module to import images and information about those images from several Koi-selling websites. Because the formatting of each website varies there is a separate function for each website. For each fish found on the website, the function downloads the picture and creates an entry with data about the fish. An example of the data file is shown in Champ_2017_10_31.csv.

The (misnamed) FeatureEngineering module does all the processing: it collects the stored data, does some simple filtering to eliminate missing or uncommon values in the dataset, reads the images as like-sized matrices, and splits it into test and training sets. It then uses the Xception pre-trained model available within Keras (using TensorFlow) to train a new model using the training set. It uses that model to make predictions on the test set.

The results of those predictions are then displayed as a confusion matrix. Additionally, 24 pictures from the test set are selected at random and displayed.

The confusion matrix highlights the class imbalance in the dataset as a whole, which is reflected in the randomly selected test set. Sanke, Showa, Kohaku are the “basic” Koi, and they are far and away the most popular. An understanding of the Koi types explains some of the results. A Tancho Kohaku, for instance, is a white fish with a red spot on its head. Apparently this was easy for the algorithm to identify. The term “Ginrin” refers to a metallic sheen of the scales. Apparently the algorithm had difficulty identifying this characteristic; of the 10 Ginrin Showa in the test set 5 were identified as Ginrin Showa while 5 were identified as Showa.

The SamplePics image shows the pictures of 24 randomly fish from the test set. It shows the labelled type and the top three types identified by the algorithm (along with their associated probabilities). Each image has a green border if the algorithm was correct and a red border otherwise. It also includes the path to the original picture.
